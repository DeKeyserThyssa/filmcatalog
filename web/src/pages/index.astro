---
import Layout from '../layouts/Layout.astro'
import {API_KEY} from '../apikey';
import Header from '../components/generic/Header.astro';

const searchTerm: string = '';

const latestMovie = await fetch(`https://api.themoviedb.org/3/movie/latest?api_key=${API_KEY}`).then((res) => res.json())

const searchMovies = await fetch(
  `https://api.themoviedb.org/3/search/movie?api_key=${
    import.meta.env.TMDB_APIKEY
  }&query=${searchTerm}`,
).then((res) => res.json())

console.log('Search Movies');

console.log(searchMovies);

function imageIsNull()
 {
   if (latestMovie.poster_path === null) {
     return '/placeholder_movie.svg'
   } else {
     return `https://image.tmdb.org/t/p/original${latestMovie.poster_path}`
   }
 }
---

<Layout title="Home">
  <Header />
  <main class="m-12 items-center justify-center">
    <h1 class="text-2xl font-bold mb-6">Latest release</h1>
    <section class="grid grid-cols-7 gap-3 pt-24">
    <div class="col-start-2">
      <img
        class="aspect-[2/3]"
        src={`${
          latestMovie.poster_path
            ? `https://image.tmdb.org/t/p/original${latestMovie.poster_path}`
            : '/placeholder_movie.svg'
        }`}
        alt={`${latestMovie.poster_path}`}
      />
    </div>
    <div class="col-start-4 col-span-3">
      <h1 class="text-4xl">
        {latestMovie.title}
      </h1>
      <p class=""><strong>language: </strong>{latestMovie.original_language}</p>
      <h2 class="text-2xl">Overview</h2>
      <p>{latestMovie.overview}</p>
      <div>
        <ul class="flex flex-column">
          {latestMovie.production_companies.map((el: any) => (
            <li class="mr-3">{el.name}</li>
          ))}
        </ul>
      </div>
      <div>
        <ul class="flex flex-column">
          {latestMovie.genres.map((el: any) => (
            <li class="mr-3">{el.name}</li>
          ))}
        </ul>
      </div>
    </div>
  </section>
</main>
</Layout>
